{% extends 'list.html' %}
{% load static %}
{% load i18n %}
{% load slippers %}
{% load partials %}
{% load psat_filter %}
{% load crispy_forms_tags %}

{% block main %}
    {% partialdef list_main inline=True %}
        {{ info|json_script:'info' }}
        <div class="pagetitle">
            <h1>{{ icon_menu|safe }} PSAT
                <span class="fs-6 text-secondary">{{ title }}</span>
            </h1>
            <nav>
                <ol class="breadcrumb" hx-target="#main" hx-swap="innerHTML swap:0.25s" hx-push-url="true">
                    <li class="breadcrumb-item">
                        <a href="{% url 'index' %}" hx-post="{% url 'index' %}">Home</a>
                    </li>
                    {% if info.view_type %}
                        <li class="breadcrumb-item">PSAT</li>
                        <li class="breadcrumb-item active">{{ info.view_type|title }}</li>
                    {% else %}
                        <li class="breadcrumb-item active">PSAT</li>
                    {% endif %}
                </ol>
            </nav>
        </div><!-- Page Title End -->

        <section class="section">
            <div class="row">
                <div class="col-12" aria-label="문제 목록">
                    <div id="problem_container" class="card htmx-fade-in htmx-fade-out"
                         hx-target="#main" hx-swap="innerHTML swap:0.25s show:window:top">
                        {% include 'psat/v4/snippets/problem_container.html' %}
                    </div>
                </div>

                {% if user.is_admin %}
                    <div class="col-12" aria-label="문제 컬렉션">
                        <div id="collectionCard" hx-swap="innerHTML swap:0.25s"
                             class="card htmx-fade-in htmx-fade-out">
                            <div id="collectionCardHeader" class="card-header">
                                문제 컬렉션
                                <a class="text-decoration-none ms-2" href=""
                                   hx-indicator="#collectionCardIndicator" hx-swap="none"
                                   hx-get="{% url 'psat:collection_reload' %}">
                                    <span class="badge rounded-pill text-bg-warning">새로고침</span>
                                </a>
                                <div id="collectionCardIndicator" role="status"
                                     class="htmx-indicator spinner-border text-warning spinner-border-sm">
                                    <span class="visually-hidden">Loading...</span>
                                </div>
                            </div>
                            <div id="collectionCardBody"
                                 class="card-body htmx-fade-in htmx-fade-out"
                                 hx-target="this" hx-trigger="load"
                                 hx-get="{% url 'psat:collection_index' %}">
                            </div>
                        </div>
                    </div>

                    <div class="col-12" aria-label="질문 리스트">
                        <div id="commentCard" class="card htmx-fade-in htmx-fade-out"
                             hx-target="#main" hx-swap="innerHTML swap:0.25s">
                            <div id="commentCardHeader" class="card-header">
                                질문 리스트
                                <a class="text-decoration-none ms-2" href=""
                                   hx-indicator="#commentCardIndicator" hx-target="#commentCardBody"
                                   hx-get="{% url 'psat:comment' %}">
                                    <span class="badge rounded-pill text-bg-warning">새로고침</span>
                                </a>
                                <div id="commentCardIndicator" role="status"
                                     class="htmx-indicator spinner-border text-warning spinner-border-sm">
                                    <span class="visually-hidden">Loading...</span>
                                </div>
                            </div>

                            <div id="commentCardBody"
                                 class="card-body htmx-fade-in htmx-fade-out"
                                 hx-target="this" hx-trigger="load"
                                 hx-get="{% url 'psat:comment' %}">
                            </div>
                        </div>
                    </div>
                {% endif %}
            </div>
        </section>
    {% endpartialdef list_main %}
{% endblock main %}
