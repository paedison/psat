{% load i18n %}

<div class="row">
    <div class="d-flex{% if comment.parent %} ps-4{% endif %}">
        <div class="me-auto">
            {% if comment.parent %}
                <span class="text-primary">{{ icon_board.reply|safe }}</span>
            {% endif %}
                {% with username=comment.username target_user=comment.user %}
                    {% include 'psat/v4/snippets/username.html' %}
                {% endwith %}
            <span class="small text-secondary ms-1">
                {{ comment.timestamp|date:'n/j(D) G:i' }}
            </span>
        </div>
        <div class="btn-group" role="group" aria-label="Comment buttons">
            {% if not comment.parent %}
                {% if user.is_authenticated %}
                    <button class="btn btn-sm btn-outline-primary"
                            hx-get="{% url 'psat:comment_create' problem_id %}?parent_id={{ comment.id }}"
                            title="{% trans 'Reply' %}"
                            hx-target="#modalContainer"
                            data-bs-toggle="modal" data-bs-target="#modalContainer">
                        {{ icon_board.reply|safe }}
                    </button>
                {% else %}
                    <button class="btn btn-sm btn-outline-primary"
                            hx-get="{% url 'account_login_modal' %}"
                            title="{% trans 'Reply' %}"
                            hx-target="#modalContainer"
                            data-bs-toggle="modal" data-bs-target="#modalContainer">
                        {{ icon_board.reply|safe }}
                    </button>
                {% endif %}
            {% endif %}

            {% if comment.user == user %}
                <button class="btn btn-sm btn-outline-success"
                        hx-get="{% url 'psat:comment_update' comment.id %}?parent_id={{ comment.parent_id|default:'' }}&page={{ page_obj.number }}"
                        title="{% trans 'Update' %}"
                        hx-target="#modalContainer"
                        data-bs-toggle="modal" data-bs-target="#modalContainer">
                    {{ icon_board.update|safe }}
                </button>
                <button class="btn btn-sm btn-outline-danger"
                        hx-post="{% url 'psat:comment_delete' comment.id %}"
                        title="{% trans 'Delete' %}"
                        hx-confirm="{% trans 'Are you sure you wish to delete your question or comment?' %}">
                    {{ icon_board.delete|safe }}
                </button>
            {% endif %}
        </div>
    </div>
</div>
<div class="row">
    <div id="commentContent{{ comment.id }}"
         class="htmx-fade-in htmx-fade-out text-gray-900 pt-2{% if comment.parent %} ps-4{% endif %}">
        {{ comment.comment|safe }}
    </div>
</div>
