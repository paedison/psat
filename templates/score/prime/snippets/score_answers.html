{% load i18n %}
{% load psat_filter %}
{% load partials %}
{% load slippers %}

<nav>
    <div class="nav nav-tabs nav-tabs-bordered" id="scoreAnswersTab" role="tablist">
        {% #nav_tab prefix='eoneo_answers' id='0' %}
            <div class="px-2">{{ icon_subject.언어|safe }} 언어</div>
        {% /nav_tab %}

        {% #nav_tab prefix='jaryo_answers' id='1' %}
            <div class="px-2">{{ icon_subject.자료|safe }} 자료</div>
        {% /nav_tab %}

        {% #nav_tab prefix='sanghwang_answers' id='2' %}
            <div class="px-2">{{ icon_subject.상황|safe }} 상황</div>
        {% /nav_tab %}

        {% #nav_tab prefix='heonbeob_answers' id='3' %}
            <div class="px-2">{{ icon_subject.헌법|safe }} 헌법</div>
        {% /nav_tab %}
    </div>
</nav>
<div class="tab-content" id="scoreAnswersContent">
    {% #nav_content prefix='eoneo_answers' id='0' %}
        {% if eoneo_answer %}
            {% #responsive_table %}
                {% with answers=eoneo_answer answer_rates=eoneo_rates %}
                    {% partial confirmed_answer_table %}
                {% endwith %}
            {% /responsive_table %}
        {% endif %}
    {% /nav_content %}

    {% #nav_content prefix='jaryo_answers' id='1' %}
        {% if jaryo_answer %}
            {% #responsive_table %}
                {% with answers=jaryo_answer answer_rates=jaryo_rates %}
                    {% partial confirmed_answer_table %}
                {% endwith %}
            {% /responsive_table %}
        {% endif %}
    {% /nav_content %}

    {% #nav_content prefix='sanghwang_answers' id='2' %}
        {% if sanghwang_answer %}
            {% #responsive_table %}
                {% with answers=sanghwang_answer answer_rates=sanghwang_rates %}
                    {% partial confirmed_answer_table %}
                {% endwith %}
            {% /responsive_table %}
        {% endif %}
    {% /nav_content %}

    {% #nav_content prefix='heonbeob_answers' id='3' %}
        {% if heonbeob_answer %}
            {% #responsive_table %}
                {% with answers=heonbeob_answer answer_rates=heonbeob_rates sub='헌법' %}
                    {% partial confirmed_answer_table %}
                {% endwith %}
            {% /responsive_table %}
        {% endif %}
    {% /nav_content %}
</div>


{% partialdef confirmed_answer_table %}
    <tbody>
        {% with loop_counter=10 loop_min=0 loop_max=10 %}
            {% partial answer_table_tr %}
        {% endwith %}
        {% with loop_counter=10 loop_min=10 loop_max=20 %}
            {% partial answer_table_tr %}
        {% endwith %}
        {% if ex == '칠급' or sub == '헌법' %}
            {% with loop_counter=5 loop_min=20 loop_max=25 %}
                {% partial answer_table_tr %}
            {% endwith %}
        {% else %}
            {% with loop_counter=10 loop_min=20 loop_max=30 %}
                {% partial answer_table_tr %}
            {% endwith %}
            {% with loop_counter=10 loop_min=30 loop_max=40 %}
                {% partial answer_table_tr %}
            {% endwith %}
        {% endif %}
    </tbody>
{% endpartialdef confirmed_answer_table %}


{% partialdef answer_table_tr %}
    <tr class="text-center table-warning">
        <td></td>
        {% for _ in 'x'|ljust:loop_counter %}
            <td class="text-nowrap fw-bold text-secondary">
                문 {{ forloop.counter|add:loop_min }}
            </td>
        {% endfor %}
    </tr>
    <tr class="text-center">
        <td class="text-nowrap align-center">정답</td>
        {% for answer in answers %}
            {% if forloop.counter > loop_min and forloop.counter <= loop_max %}
                <td>
                    <button class="btn btn-circle btn-sm fs-6 mx-1 my-2 btn-outline-secondary">
                        {{ answer.answer }}</button>
                </td>
            {% endif %}
        {% endfor %}
    </tr>
    <tr class="text-center">
        <td class="text-nowrap">제출 답안</td>
        {% for answer in answers %}
            {% if forloop.counter > loop_min and forloop.counter <= loop_max %}
                <td>
                    <button class="btn btn-circle btn-sm fs-6 mx-1 my-2
                        btn-{% if answer.result == 'O' %}success{% else %}danger{% endif %}">
                        {{ answer.student_answer }}</button>
                </td>
            {% endif %}
        {% endfor %}
    </tr>
    <tr class="text-center">
        <td class="text-nowrap" >정답률(%)</td>
        {% for answer_rate in answer_rates %}
            {% if forloop.counter > loop_min and forloop.counter <= loop_max %}
                <td>
                    <span data-number="{{ answer_rate.problem__number }}">
                        {{ answer_rate.correct|floatformat:0 }}
                    </span>
                </td>
            {% endif %}
        {% endfor %}
    </tr>
{% endpartialdef answer_table_tr %}
