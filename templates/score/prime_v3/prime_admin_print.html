{% extends 'base.html' %}
{% load static %}
{% load i18n %}
{% load psat_filter %}
{% load partials %}
{% load slippers %}
{% load humanize %}

{% block head_title %}제{{ round }}회_전국모의고사_성적통계{% endblock head_title %}
{% block google_adsense %}{% endblock %}

{% block html_body %}
<body class="bg-white">
    {{ info|json_script:'info' }}
    <h2 class="fw-bold text-center mb-4">{{ sub_title }} 성적표</h2>
    <div class="mb-2">
        <table class="table table-sm table-bordered small align-middle">
            <thead>
                <tr class="text-center small align-middle">
                    <th rowspan="2">직렬</th>
                    <th rowspan="2">응시 인원</th>
                    <th colspan="4">헌법</th>
                    <th colspan="4">언어논리</th>
                    <th colspan="4">자료해석</th>
                    <th colspan="4">상황판단</th>
                    <th colspan="4">PSAT</th>
                </tr>

                <tr class="text-center small align-middle">
                    <th>최고<br/>점수</th>
                    <th>상위<br/>10%</th>
                    <th>상위<br/>20%</th>
                    <th>평균<br/>점수</th>

                    <th>최고<br/>점수</th>
                    <th>상위<br/>10%</th>
                    <th>상위<br/>20%</th>
                    <th>평균<br/>점수</th>

                    <th>최고<br/>점수</th>
                    <th>상위<br/>10%</th>
                    <th>상위<br/>20%</th>
                    <th>평균<br/>점수</th>

                    <th>최고<br/>점수</th>
                    <th>상위<br/>10%</th>
                    <th>상위<br/>20%</th>
                    <th>평균<br/>점수</th>

                    <th>최고<br/>점수</th>
                    <th>상위<br/>10%</th>
                    <th>상위<br/>20%</th>
                    <th>평균<br/>점수</th>
                </tr>
            </thead>
            <tbody>
                {% if statistics %}
                    {% for obj in statistics %}
                        <tr class="text-center small align-middle">
                            <td>{{ obj.department }}</td>
                            <td>{{ obj.num_students|intcomma }}</td>

                            <td>{{ obj.max_score_heonbeob|floatformat:1 }}</td>
                            <td>{{ obj.top_score_10_heonbeob|floatformat:1 }}</td>
                            <td>{{ obj.top_score_20_heonbeob|floatformat:1 }}</td>
                            <td>{{ obj.avg_score_heonbeob|floatformat:1 }}</td>

                            <td>{{ obj.max_score_eoneo|floatformat:1 }}</td>
                            <td>{{ obj.top_score_10_eoneo|floatformat:1 }}</td>
                            <td>{{ obj.top_score_20_eoneo|floatformat:1 }}</td>
                            <td>{{ obj.avg_score_eoneo|floatformat:1 }}</td>

                            <td>{{ obj.max_score_jaryo|floatformat:1 }}</td>
                            <td>{{ obj.top_score_10_jaryo|floatformat:1 }}</td>
                            <td>{{ obj.top_score_20_jaryo|floatformat:1 }}</td>
                            <td>{{ obj.avg_score_jaryo|floatformat:1 }}</td>

                            <td>{{ obj.max_score_sanghwang|floatformat:1 }}</td>
                            <td>{{ obj.top_score_10_sanghwang|floatformat:1 }}</td>
                            <td>{{ obj.top_score_20_sanghwang|floatformat:1 }}</td>
                            <td>{{ obj.avg_score_sanghwang|floatformat:1 }}</td>

                            <td>{{ obj.max_score_psat_avg|floatformat:1 }}</td>
                            <td>{{ obj.top_score_10_psat_avg|floatformat:1 }}</td>
                            <td>{{ obj.top_score_20_psat_avg|floatformat:1 }}</td>
                            <td>{{ obj.avg_score_psat_avg|floatformat:1 }}</td>
                        </tr>
                    {% endfor %}
                {% endif %}
            </tbody>
        </table>
    </div>
    <div class="mb-2">
        <table class="table table-sm table-bordered small align-middle">
            <thead>
                <tr class="text-center small align-middle">
                    <th rowspan="3">등수</th>
                    <th rowspan="3">이름</th>
                    <th rowspan="3">수험번호</th>
                    <th rowspan="3">직렬</th>

                    <th colspan="5">헌법</th>
                    <th colspan="5">언어논리</th>
                    <th colspan="5">자료해석</th>
                    <th colspan="5">상황판단</th>
                    <th colspan="6">PSAT</th>
                </tr>

                <tr class="text-center small align-middle">
                    <th rowspan="2">점수</th>
                    <th colspan="2">전체<br/>석차</th>
                    <th colspan="2">직렬<br/>석차</th>

                    <th rowspan="2">점수</th>
                    <th colspan="2">전체<br/>석차</th>
                    <th colspan="2">직렬<br/>석차</th>

                    <th rowspan="2">점수</th>
                    <th colspan="2">전체<br/>석차</th>
                    <th colspan="2">직렬<br/>석차</th>

                    <th rowspan="2">점수</th>
                    <th colspan="2">전체<br/>석차</th>
                    <th colspan="2">직렬<br/>석차</th>

                    <th rowspan="2">총점</th>
                    <th rowspan="2">평균</th>
                    <th colspan="2">전체<br/>석차</th>
                    <th colspan="2">직렬<br/>석차</th>
                </tr>

                <tr class="text-center small align-middle">
                    <th>등</th>
                    <th>%</th>
                    <th>등</th>
                    <th>%</th>

                    <th>등</th>
                    <th>%</th>
                    <th>등</th>
                    <th>%</th>

                    <th>등</th>
                    <th>%</th>
                    <th>등</th>
                    <th>%</th>

                    <th>등</th>
                    <th>%</th>
                    <th>등</th>
                    <th>%</th>

                    <th>등</th>
                    <th>%</th>
                    <th>등</th>
                    <th>%</th>
                </tr>
            </thead>
            <tbody>
                {% if page_obj %}
                    {% for obj in page_obj %}
                        <tr class="text-center small align-middle">
                            <td>{{ obj.rank_total_psat }}</td>
                            <td class="text-nowrap">{{ obj.student.name }}</td>
                            <td class="text-nowrap">{{ obj.student.serial }}</td>
                            <td class="text-nowrap">{{ obj.student.department.name }}</td>

                            <td>{{ obj.score_heonbeob|floatformat:1 }}</td>
                            <td>{{ obj.rank_total_heonbeob }}</td>
                            <td>{{ obj.rank_ratio_total_heonbeob|percentage|floatformat:1 }}</td>
                            <td>{{ obj.rank_department_heonbeob }}</td>
                            <td>{{ obj.rank_ratio_department_heonbeob|percentage|floatformat:1 }}</td>

                            <td>{{ obj.score_eoneo|floatformat:1 }}</td>
                            <td>{{ obj.rank_total_eoneo }}</td>
                            <td>{{ obj.rank_ratio_total_eoneo|percentage|floatformat:1 }}</td>
                            <td>{{ obj.rank_department_eoneo }}</td>
                            <td>{{ obj.rank_ratio_department_eoneo|percentage|floatformat:1 }}</td>

                            <td>{{ obj.score_jaryo|floatformat:1 }}</td>
                            <td>{{ obj.rank_total_jaryo }}</td>
                            <td>{{ obj.rank_ratio_total_jaryo|percentage|floatformat:1 }}</td>
                            <td>{{ obj.rank_department_jaryo }}</td>
                            <td>{{ obj.rank_ratio_department_jaryo|percentage|floatformat:1 }}</td>

                            <td>{{ obj.score_sanghwang|floatformat:1 }}</td>
                            <td>{{ obj.rank_total_sanghwang }}</td>
                            <td>{{ obj.rank_ratio_total_sanghwang|percentage|floatformat:1 }}</td>
                            <td>{{ obj.rank_department_sanghwang }}</td>
                            <td>{{ obj.rank_ratio_department_sanghwang|percentage|floatformat:1 }}</td>

                            <td>{{ obj.score_psat|floatformat:1 }}</td>
                            <td>{{ obj.score_psat_avg|floatformat:1 }}</td>
                            <td>{{ obj.rank_total_psat }}</td>
                            <td>{{ obj.rank_ratio_total_psat|percentage|floatformat:1 }}</td>
                            <td>{{ obj.rank_department_psat }}</td>
                            <td>{{ obj.rank_ratio_department_psat|percentage|floatformat:1 }}</td>
                        </tr>
                    {% endfor %}
                {% endif %}
            </tbody>
        </table>
    </div>

    <script>
        window.onload = function () {
            setTimeout(function () {
                window.print();
            }, 1000);
        };
    </script>
</body>
{% endblock html_body %}
